<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PauseBuy</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>

<div class="container">

    <h1>PauseBuy ðŸ›’</h1>
    <p class="tagline">
        Add what you own. Pause before you buy.
    </p>

    <!-- ================= ADD TO MY CLOSET ================= -->
    <div class="card">
        <h3>Add to My Closet</h3>

        <form action="/add" method="POST" enctype="multipart/form-data">
            <input type="file" name="image" accept="image/*" required>
            <button type="submit">Add to Closet</button>
        </form>
    </div>

    <!-- MESSAGE AFTER ADD -->
    {% if message %}
        <div class="card result">
            {{ message }}
        </div>
    {% endif %}

    <!-- ================= CHECK BEFORE BUYING ================= -->
    <div class="card">
        <h3>Can I Buy This?</h3>

        <form action="/check" method="POST" enctype="multipart/form-data">

            <!-- TEXT QUERY (OPTIONAL) -->
            <input
                type="text"
                name="item_text"
                placeholder="Optional: e.g. red t-shirt"
            >

            <!-- IMAGE UPLOAD -->
            <input
                type="file"
                name="item_image"
                accept="image/*"
                required
            >

            <button type="submit">
                Can I buy this?
            </button>
        </form>
    </div>

    <!-- ================= RESULT MESSAGE ================= -->
    {% if result %}
        <div class="alert">
            {{ result }}

            {% if matches is defined and matches|length > 0 %}
                <p style="font-size:13px;color:#777;">
                    Matched based on category and visual similarity
                </p>
            {% endif %}
        </div>
    {% endif %}

    <!-- ================= MATCHED ITEMS ================= -->
    {% if matches is defined and matches|length > 0 %}
        <div style="
            display:flex;
            gap:16px;
            flex-wrap:wrap;
            margin-top:16px;
        ">
            {% for item in matches %}
                <div style="
                    width:150px;
                    background:#ffffff;
                    border-radius:14px;
                    box-shadow:0 6px 16px rgba(0,0,0,0.08);
                    padding:10px;
                    text-align:center;
                ">
                    <img
                        src="{{ item.image }}"
                        alt="Matched item"
                        style="
                            width:100%;
                            height:170px;
                            object-fit:cover;
                            border-radius:10px;
                        "
                    />

                    <div style="
                        margin-top:8px;
                        font-size:13px;
                        font-weight:600;
                    ">
                        {{ item.color }} {{ item.category }}
                    </div>
                </div>
            {% endfor %}
        </div>
    {% endif %}

    <!-- ================= VIEW CLOSET ================= -->
    <div class="card">
        <button class="primary-btn" onclick="location.href='/closet'">
            ðŸ§º View My Closet
        </button>
    </div>

</div>

</body>
</html>
